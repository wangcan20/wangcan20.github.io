---
title: "Survival analysis note 6"
date: 2025-08-02
math: true
#categories: [test-category]
#tags: [test-tag]
---


# Competing Risks Analysis


---

## 1. **Setting: Competing Risks Framework**

- Individuals may fail for different, mutually exclusive reasons (causes).
- The time to first failure and its cause are recorded.


**Notation:**
- $T$: event time
- $J \in \{1,\dots,K\}$ is the cause of failure
- $K$: number of possible causes

---


## 2. **Key Functions and Formulas**

### **2.1. Marginal and Subdistribution Functions**
- **Marginal survival function:**
  \[
  S(t) = P(T > t) = 1-\sum_{j=1}^K F_j(t)
  \]
- **Cumulative incidence function (CIF) for cause $j$:**
  \[
  F_j(t) = P(T \leq t, J = j) = \int_0^t f_j(u)\,du
  \]

### **2.2. Cause-Specific Hazard**
- **Cause-specific hazard for cause $j$:**
  \[
  \lambda_j(t) = \lim_{\Delta t\to 0}\frac{P(t \leq T < t + \Delta t, J=j|T \geq t)}{\Delta t}
  \]

- **Total hazard:** $ \lambda(t) = \sum_{j=1}^K \lambda_j(t) $

- **Subdistribution density:** $ f_j(t) = \lambda_j(t) S(t) $

### **2.3. CIF from Hazards**
\[
F_j(t) = \int_0^t \lambda_j(u) S(u)\,du
\]
where
\[
S(u) = \exp\left(-\int_0^u \sum_{j=1}^K \lambda_j(s) ds \right)
\]

---

## 3. **Estimation Methods**

### **3.1. Estimation of CIF ($ \hat{F}_j(t) $)**
**Nonparametric estimator (Aalen-Johansen):**

\[
\hat{F}_j(t) = \sum_{k: t_k \leq t} \hat{S}(t_{k-1}) \frac{d_j(t_k)}{n_{\text{risk}}(t_k)}
\]

- $ d_j(t_k) $: number of events of type $j$ at time $t_k$
- $ n_{\text{risk}}(t_k) $: number at risk at $ t_k $
- $ \hat{S}(t_{k-1}) $: Kaplan-Meier estimate up to previous time

### **3.2. Regression Models**

#### **A. Cause-Specific Cox Model**
- For each cause $j$, fit separate Cox model treating other events as censored.
- **Interpretation:** Covariate effects on the instantaneous risk (hazard) for a specific cause.
- **Limitation:** May not easily link to CIF; sensitive to the presence of competing events.

#### **B. Fine-Gray Subdistribution Hazard Model**
- Models subdistribution hazard:
\[
    \tilde{\lambda}_j(t) = \lim_{\Delta t \to 0} \frac{P(t \leq T < t+\Delta t, J=j|T \geq t \cup (T \leq t \cap J\neq j))}{\Delta t}
\]
- **Interprets** covariate effect directly on CIF.
- **Can only accommodate baseline covariates** (not time-dependent).
